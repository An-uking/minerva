(function(){importScripts("http://cdn.coursevector.com/minerva/4.1.0/js/lib/ByteArray.js","http://cdn.coursevector.com/minerva/4.1.0/js/lib/AMF0.js","http://cdn.coursevector.com/minerva/4.1.0/js/lib/AMF3.js");var g=new AMF0,e=new AMF3;onmessage=function(b){var k=b.data.fileName,h=b.data.amfVersion,f=b.data.data,c=new ByteArray(null,ByteArray.LITTLE_ENDIAN),a=new ByteArray(null,ByteArray.LITTLE_ENDIAN);g.reset();e.reset();a.writeUTFBytes("TCSO");a.writeByte(0);a.writeByte(4);a.writeByte(0);a.writeByte(0);a.writeByte(0);a.writeByte(0);a.writeUTF(k);a.writeUnsignedInt(h);for(var d in f)3==h?(e.writeString(a,d),e.writeData(a,
f[d])):(a.writeUTF(d),g.writeData(a,f[d])),a.writeByte(0);c.writeByte(0);c.writeByte(191);c.writeUnsignedInt(a.position);c.writeBytes(a);b.data.filePath&&(c.writeByte(0),c.writeByte(255),c.writeUnsignedInt(b.data.filePath.length+2),c.writeUTF(b.data.filePath));b=new Int8Array(c._buffer.slice(0,c.position));b=Array.apply([],b);postMessage({data:b})}})();
