(function(){importScripts("../lib/ByteArray.js","../lib/AMF0.js","../lib/AMF3.js");var g=new AMF0,f=new AMF3;onmessage=function(b){var d=b.data.fileName,h=b.data.amfVersion;b=b.data.data;var c=new ByteArray(null,ByteArray.LITTLE_ENDIAN),a=new ByteArray(null,ByteArray.LITTLE_ENDIAN);g.reset();f.reset();a.writeUTFBytes("TCSO");a.writeByte(0);a.writeByte(4);a.writeByte(0);a.writeByte(0);a.writeByte(0);a.writeByte(0);a.writeUTF(d);a.writeUnsignedInt(h);for(var e in b)3==h?(f.writeString(a,e),f.writeData(a,
b[e])):(a.writeUTF(e),g.writeData(a,b[e])),a.writeByte(0);c.writeByte(0);c.writeByte(191);c.writeUnsignedInt(a.position);c.writeBytes(a);d=new Int8Array(c._buffer.slice(0,c.position));d=Array.apply([],d);postMessage({data:d})}})();
