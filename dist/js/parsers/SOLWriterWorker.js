(function(){importScripts("http://cdn.coursevector.com/minerva/4.1.3/js/lib/ByteArray.js","http://cdn.coursevector.com/minerva/4.1.3/js/lib/AMF0.js","http://cdn.coursevector.com/minerva/4.1.3/js/lib/AMF3.js");var g=new AMF0,e=new AMF3;onmessage=function(c){var k=c.data.fileName,h=c.data.amfVersion,f=c.data.data,b=new ByteArray(null,ByteArray.LITTLE_ENDIAN),a=new ByteArray(null,ByteArray.LITTLE_ENDIAN);g.reset();e.reset();a.writeUTFBytes("TCSO");a.writeByte(0);a.writeByte(4);a.writeByte(0);a.writeByte(0);a.writeByte(0);a.writeByte(0);a.writeUTF(k);a.writeUnsignedInt(h);for(var d in f)3==h?(e.writeString(a,d),e.writeData(a,
f[d])):(a.writeUTF(d),g.writeData(a,f[d])),a.writeByte(0);b.writeByte(0);b.writeByte(191);b.writeUnsignedInt(a.position);b.writeBytes(a);c.data.filePath&&(b.writeByte(0),b.writeByte(255),a=new ByteArray(null,ByteArray.LITTLE_ENDIAN),a.writeUTF(c.data.filePath),b.writeUnsignedInt(a.position),b.writeBytes(a));c=new Int8Array(b._buffer.slice(0,b.position));c=Array.apply([],c);postMessage({data:c})}})();
