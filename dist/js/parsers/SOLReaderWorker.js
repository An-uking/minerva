(function(){importScripts("http://cdn.coursevector.com/minerva/4.0.4/js/lib/ByteArray.js","http://cdn.coursevector.com/minerva/4.0.4/js/lib/AMF0.js","http://cdn.coursevector.com/minerva/4.0.4/js/lib/AMF3.js");var g=new AMF0,e=new AMF3,h=function(){for(var a=[],c=0,b=arguments.length;c<b;c++)a[c]=arguments[c];postMessage({type:"warning",message:a})};onmessage=function(a){var c=a.data.fileID;a=new ByteArray(a.data.text,ByteArray.BIG_ENDIAN);var b={};g.reset();e.reset();var d=a.getBytesAvailable();b.header={};a.readUnsignedShort();b.header.dataLength=a.readUnsignedInt();d!=b.header.dataLength+6&&h("Warning: Data Length Mismatch (File Size:"+
d+" != Reported Size:"+(b.header.dataLength+6)+")");if("TCSO"!=a.readUTFBytes(4))throw"Missing TCSO signature, not a SOL file";a.readUTFBytes(6);b.header.fileName=a.readUTFBytes(a.readUnsignedShort());b.header.amfVersion=a.readUnsignedInt();0===b.header.amfVersion||3===b.header.amfVersion?"undefined"==b.header.fileName&&(b.header.fileName="[SOL Name not Set]"):b.header.fileName="[Not yet supported SOL format]";if(0==b.header.amfVersion||3==b.header.amfVersion)for(b.body={};1<a.getBytesAvailable();){var d=
"",f;3==b.header.amfVersion?(d=e.readString(a).value,f=e.readData(a)):(d=a.readUTF(),f=g.readData(a));a.readUnsignedByte();b.body[d]=f}postMessage({fileID:c,data:b})}})();
